<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FOSSO Logo Upload</title>
    <link rel="stylesheet" type="text/css" href="./style.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
    </style>
    <script src="./htmx.min.js"></script>
</head>

<body>
    <header>
        <ul>
            <li><a href="/">Dashboard</a></li>
            <li><a href="/chromakey" target="_blank">Overlay</a></li>
            <li><a href="#" class="active4">Upload Logos</a></li>
        </ul>
    </header>
    <form hx-post="/logo_upload" class="logo-upload" hx-encoding="multipart/form-data" onsubmit="return submitForm(event);">
        <label for="home_img">Home Team Logo:</label>
        <input type="file" name="home.png" id="home_img" accept="image/png" onchange="previewImage(this, 'home_preview')"><br>
        <img id="home_preview" src="#" alt="Home Team Logo Preview" style="display:none; max-height: 50px; max-width: 50px;"><br>

        <label for="away_img">Away Team Logo:</label>
        <input type="file" name="away.png" id="away_img" accept="image/png" onchange="previewImage(this, 'away_preview')">
        <img id="away_preview" src="#" alt="Away Team Logo Preview" style="display:none; max-height: 50px; max-width: 50px;">

        <div class="team-input">
            <label for="home">Home Name: </label>
            <input type="text" id="home" name="home" maxlength="8">
        </div>
        <div class="team-input">
            <label for="away">Away Name: </label>
            <input type="text" id="away" name="away" maxlength="8">
        </div>

        <input type="submit" value="Submit" id="file-submit">
    </form>

    <script>
        function previewImage(input, previewId) {
            var preview = document.getElementById(previewId);
            var file = input.files[0];
            var reader = new FileReader();

            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
            };

            if (file) {
                reader.readAsDataURL(file);
            } else {
                preview.src = '#';
                preview.style.display = 'none';
            }
        }

        function submitForm(event) {
            event.preventDefault();
            console.log("submitForm function called");
            var home = document.getElementById('home').value;
            var away = document.getElementById('away').value;
            if (home && away) {
                var xhr = new XMLHttpRequest();
                xhr.open("POST", "/", true);
                xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                xhr.onreadystatechange = function() {
                    if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                        console.log("Request finished and response is ready.");
                    }
                };
                xhr.send("home=" + home + "&away=" + away);
            }
        }
    </script>
</body>
</html>
